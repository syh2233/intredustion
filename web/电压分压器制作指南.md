# DHT22电压分压器制作指南

## 问题分析

根据你的ESP32输出，主要问题是：
- GPIO32始终为低电平(0)，应为高电平(1)
- DHT22读取到0值，无法正常通信

## 解决方案：电压分压器

### 为什么需要电压分压器？

- DHT22工作电压：5V
- ESP32 GPIO最大电压：3.3V
- 直接连接会损坏ESP32

### 推荐方案

#### 方案1：电阻分压器（推荐）
```
DHT22 DATA引脚 ──┬─── 10KΩ电阻 ──┬─── GPIO32
                  │               │
                  └─── 20KΩ电阻 ──┴─── GND
```

**计算：**
- 输入电压：5V
- 分压比例：20K/(10K+20K) = 2/3
- 输出电压：5V × 2/3 = 3.33V（安全！）

#### 方案2：简单二极管保护
```
DHT22 DATA引脚 ──┬─── 1N4148二极管 ──┬─── GPIO32
                  │                   │
                  └─── 10KΩ电阻 ──────┴─── GND
```

### 制作步骤

#### 材料准备
- 10KΩ电阻 × 1
- 20KΩ电阻 × 1
- 杜邦线若干
- 面包板（可选）

#### 连接步骤
1. 将DHT22的DATA引脚连接到10KΩ电阻的一端
2. 将10KΩ电阻的另一端连接到GPIO32和20KΩ电阻
3. 将20KΩ电阻的另一端连接到GND
4. DHT22的VCC连接到5V
5. DHT22的GND连接到GND

### 接线图

```
DHT22传感器：
┌─────────────┐
│  VCC   GND  │
│   │     │   │
│  5V    GND  │
│             │
│ DATA        │
│   │         │
└─────┬───────┘
      │
      ├── 10KΩ ───┐
      │            │
      └── 20KΩ ───┼─── GPIO32
                   │
                  GND
```

### 测试步骤

1. **断开ESP32电源**
2. **按图连接电压分压器**
3. **重新连接ESP32电源**
4. **运行测试代码**：
   ```python
   # 运行简化测试代码
   python dht22_simple_test.py
   ```

### 预期结果

成功连接后，你应该看到：
- GPIO32状态为高电平(1)
- 成功读取到非0的温度和湿度值

### 如果仍然失败

#### 检查事项
1. **电阻值是否正确**：用万用表测量电阻值
2. **连接是否牢固**：检查所有连接点
3. **传感器是否损坏**：尝试更换DHT22
4. **电源是否稳定**：5V电源是否稳定

#### 备用方案
如果电压分压器仍不工作，尝试：
1. **添加上拉电阻**：在GPIO32和3.3V之间加4.7KΩ上拉电阻
2. **更换传感器**：可能DHT22已损坏
3. **使用DHT11**：尝试用DHT11代码测试

### 安全注意事项

⚠️ **重要提醒**：
- 严禁将5V直接连接到ESP32 GPIO
- 确保电压分压器连接正确
- 先断电再改接线
- 长期使用建议改用3.3V电源

### 成功标志

当电压分压器工作正常时：
- GPIO32读取值为1（高电平）
- 能成功读取温湿度数据
- 数据在合理范围内（温度：-40~80°C，湿度：0~100%）